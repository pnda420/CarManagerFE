<div class="container form-wrap" aria-label="Formular f√ºr One-Pager Anfrage">
    <header class="form-head">
        <div class="head-actions">
            <a class="btn btn--ghost" (click)="router.navigate(['/services/one-pager'])"
                aria-label="Zur√ºck zur One-Pager Seite">‚Üê Zur√ºck</a>
        </div>
        <h1>One‚ÄëPager Anfrage</h1>
        <p class="subtitle">F√ºr Privatpersonen, Vereine oder Unternehmen. Pflichtfelder sind mit * markiert.</p>
        <div class="progress" aria-label="Fortschritt">
            <div class="progress__bar" [style.width.%]="getProgressPercentage()"></div>
        </div>
    </header>

    <form class="op-form" [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
        <!-- Abschnitt: Kontakt -->
        <section class="form-section cardlike" aria-labelledby="sec-contact">
            <h2 id="sec-contact" class="section-title">
                <span class="section-number">01</span> Kontakt
            </h2>

            <div class="form-row">
                <div class="form-group">
                    <label for="firstName">Vorname <span class="required">*</span></label>
                    <input id="firstName" type="text" formControlName="firstName" placeholder=""
                        [class.error-input]="isFieldInvalid('firstName')" />
                    <p class="help">Wie sollen wir dich/Sie ansprechen?</p>
                    <span class="error-message" *ngIf="isFieldInvalid('firstName')"><i class="error-icon">!</i>Vorname
                        ist erforderlich.</span>
                </div>

                <div class="form-group">
                    <label for="lastName">Nachname <span class="required">*</span></label>
                    <input id="lastName" type="text" formControlName="lastName" placeholder=""
                        [class.error-input]="isFieldInvalid('lastName')" />
                    <p class="help">Familienname.</p>
                    <span class="error-message" *ngIf="isFieldInvalid('lastName')"><i class="error-icon">!</i>Nachname
                        ist erforderlich.</span>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="email">E‚ÄëMail <span class="required">*</span></label>
                    <div class="input-with-icon">
                        <i class="input-icon" aria-hidden="true">‚úâ</i>
                        <input id="email" type="email" formControlName="email" placeholder="name@domain.de"
                            [class.error-input]="isFieldInvalid('email')" />
                    </div>
                    <p class="help">F√ºr R√ºckfragen und die Entw√ºrfe.</p>
                    <span class="error-message" *ngIf="isFieldInvalid('email')"><i class="error-icon">!</i>Bitte eine
                        g√ºltige E‚ÄëMail-Adresse eingeben.</span>
                </div>

                <div class="form-group">
                    <label for="phone">Telefon <span class="optional">(optional)</span></label>
                    <div class="input-with-icon">
                        <i class="input-icon" aria-hidden="true">üì±</i>
                        <input id="phone" type="tel" formControlName="phone" placeholder="z.‚ÄØB. +49 123 456789" />
                    </div>
                    <p class="help">Nur wenn Anruf gew√ºnscht ist.</p>
                </div>
            </div>
        </section>

        <!-- Abschnitt: Projekt/Infos -->
        <section class="form-section cardlike" aria-labelledby="sec-project">
            <h2 id="sec-project" class="section-title">
                <span class="section-number">02</span> Projekt / Infos
            </h2>

            <div class="form-group">
                <label for="projectName">Titel oder Name <span class="optional">(optional)</span></label>
                <input id="projectName" type="text" formControlName="projectName"
                    placeholder="z. B. Name, Firmenname, Projektname" />
                <p class="help">Wie d√ºrfen wir das Vorhaben nennen?</p>
            </div>


            <div class="form-group">
                <label for="role">F√ºr wen ist die Seite? <span class="required">*</span></label>
                <select id="role" formControlName="role" [class.error-input]="isFieldInvalid('role')">
                    <option value="">Bitte w√§hlen‚Ä¶</option>
                    <option value="private">Privat</option>
                    <option value="club">Verein / Gruppe</option>
                    <option value="business">Unternehmen / Selbstst√§ndig</option>
                    <option value="nonprofit">Gemeinn√ºtzig</option>
                </select>
                <span class="error-message" *ngIf="isFieldInvalid('role')"><i class="error-icon">!</i>Bitte
                    w√§hlen.</span>
            </div>


            <div class="form-group">
                <div class="switch-container">
                    <label class="switch">
                        <input type="checkbox" formControlName="useImage" />
                        <span class="slider"></span>
                    </label>
                    <span class="switch-label">Bild/Logo verwenden (optional)</span>
                </div>
            </div>

            <!-- NUR Link, KEIN Upload -->
            <div class="logo-upload" *ngIf="form.get('useImage')?.value">
                <div class="form-group">
                    <label for="projectImage">Bild/Logo verlinken</label>
                    <input id="projectImage" type="url" formControlName="projectImage"
                        placeholder="https://example.com/bild.png" />
                    <p class="help">Nur Links (PNG, JPG, SVG). Kein Upload.</p>
                </div>
            </div>
        </section>

        <!-- Abschnitt: Design -->
        <section class="form-section cardlike" aria-labelledby="sec-design">
            <h2 id="sec-design" class="section-title">
                <span class="section-number">03</span> Design & Stil
            </h2>

            <div class="form-group">
                <label>Farben</label>
                <div class="color-picker-group">
                    <div class="color-item">
                        <input id="primaryColor" type="color" formControlName="primaryColor" class="color-input" />
                        <label for="primaryColor" class="color-label">Prim√§rfarbe <span class="color-value">{{
                                form.get('primaryColor')?.value }}</span></label>
                    </div>
                    <div class="color-item">
                        <input id="secondaryColor" type="color" formControlName="secondaryColor" class="color-input" />
                        <label for="secondaryColor" class="color-label">Sekund√§rfarbe <span class="color-value">{{
                                form.get('secondaryColor')?.value }}</span></label>
                    </div>
                    <div class="color-item">
                        <input id="accentColor" type="color" formControlName="accentColor" class="color-input" />
                        <label for="accentColor" class="color-label">Akzentfarbe <span class="color-value">{{
                                form.get('accentColor')?.value }}</span></label>
                    </div>
                </div>
            </div>


            <div class="form-group">
                <label for="designStyle">Stil <span class="required">*</span></label>
                <select id="designStyle" formControlName="designStyle"
                    [class.error-input]="isFieldInvalid('designStyle')">
                    <option value="">Bitte w√§hlen‚Ä¶</option>
                    <option value="modern">Modern & minimal</option>
                    <option value="friendly">Freundlich & klar</option>
                    <option value="elegant">Elegant</option>
                    <option value="playful">Verspielt</option>
                    <option value="bold">Auff√§llig</option>
                </select>
                <span class="error-message" *ngIf="isFieldInvalid('designStyle')"><i class="error-icon">!</i>Bitte
                    Stil w√§hlen.</span>
            </div>
        </section>

        <!-- Abschnitt: Inhalte -->
        <section class="form-section cardlike" aria-labelledby="sec-details">
            <h2 id="sec-details" class="section-title">
                <span class="section-number">04</span> Inhalte
            </h2>

            <div class="form-group">
                <label>Art der Seite <span class="required">*</span></label>
                <div class="radio-group">
                    <label class="radio-card" *ngFor="let type of websiteTypes">
                        <input type="radio" name="typeOfWebsite" [value]="type.value" formControlName="typeOfWebsite" />
                        <div class="radio-card-content">
                            <i class="radio-icon" aria-hidden="true">{{ type.icon }}</i>
                            <span class="radio-title">{{ type.label }}</span>
                            <span class="radio-description">{{ type.description }}</span>
                        </div>
                    </label>
                </div>
                <span class="error-message" *ngIf="isFieldInvalid('typeOfWebsite')"><i class="error-icon">!</i>Bitte
                    w√§hlen.</span>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="targetAudience">Zielgruppe <span class="required">*</span></label>
                    <input id="targetAudience" type="text" formControlName="targetAudience"
                        placeholder="z.‚ÄØB. G√§ste, Familien, Vereinsmitglieder, Kundschaft"
                        [class.error-input]="isFieldInvalid('targetAudience')" />
                    <p class="help">Wer soll sich angesprochen f√ºhlen?</p>
                </div>

                <div class="form-group">
                    <label for="language">Sprache</label>
                    <select id="language" formControlName="language">
                        <option value="de">Deutsch</option>
                        <option value="en">Englisch</option>
                        <option value="multi">Mehrsprachig</option>
                    </select>
                    <p class="help">Welche Sprache soll verwendet werden?</p>
                </div>
            </div>

            <div class="form-group">
                <label>Funktionen (optional)</label>
                <div class="checkbox-group">
                    <label class="checkbox-item" *ngFor="let feature of features">
                        <input type="checkbox" [value]="feature.value"
                            (change)="onFeatureChange($event, feature.value)" />
                        <span class="checkbox-custom"></span>
                        <span class="checkbox-label">{{ feature.label }}</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="contentInformation">Kurzbeschreibung & Ziel <span class="required">*</span>
                    <span class="char-count">{{ getCharCount() }}/1000</span>
                </label>
                <textarea id="contentInformation" rows="6" formControlName="contentInformation"
                    placeholder="In 3‚Äì5 S√§tzen: Worum geht es? Was ist wichtig? Welche Aktion sollen Besucher ausf√ºhren (Anrufen, Termin, Formular, Spenden)?"
                    [class.error-input]="isFieldInvalid('contentInformation')" maxlength="1000"></textarea>
                <p class="help">Konkret ist besser als lang.</p>
                <span class="error-message" *ngIf="isFieldInvalid('contentInformation')"><i
                        class="error-icon">!</i>Bitte Ihr Vorhaben in mindestens 20 Zeichen beschreiben.</span>
            </div>
        </section>

        <!-- Aktionen -->
        <div class="form-actions">
            <button type="button" class="btn btn--ghost" (click)="onReset()">Zur√ºcksetzen</button>
            <button type="submit" class="btn btn--primary" [disabled]="loading || form.invalid"
                [class.loading]="loading">
                @if (loading === false) {
                <span class="btn-text">Absenden</span>
                }
                @if (loading === true) {
                <span class="btn-text"><i class="spinner" aria-hidden="true"></i>Bitte warten...</span>
                }
            </button>
        </div>

        <div class="form-summary ok" *ngIf="form.valid">
            <div class="summary-icon" aria-hidden="true">‚úì</div>
            <p>Alle Pflichtfelder sind ausgef√ºllt. Sie k√∂nnen absenden.</p>
        </div>
    </form>
</div>