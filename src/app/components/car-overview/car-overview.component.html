<!-- src/app/features/cars/cars-overview/cars-overview.component.html -->
<app-page-title title="Meine Autos"></app-page-title>

<section class="cars-page">
    <div class="container">

        <!-- Header Actions -->
        <div class="page-header">
            <div class="header-info">
                <h2>Deine Garage</h2>
                <p>Verwalte deine Fahrzeuge und behalte den Überblick</p>
            </div>
            <button class="btn btn--primary btn--large" (click)="openCreateModal()">
                <span class="material-symbols-outlined">add</span>
                Neues Auto
            </button>
        </div>

        <!-- Loading State -->
        <div class="loading-container" *ngIf="loading && cars.length === 0">
            <div class="spinner"></div>
            <p>Lade Autos...</p>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="!loading && cars.length === 0">
            <div class="empty-icon">
                <span class="material-symbols-outlined">directions_car</span>
            </div>
            <h3>Noch keine Autos</h3>
            <p>Füge dein erstes Auto hinzu, um loszulegen!</p>
            <button class="btn btn--primary btn--large" (click)="openCreateModal()">
                <span class="material-symbols-outlined">add</span>
                Erstes Auto hinzufügen
            </button>
        </div>

        <!-- Cars Grid -->
        <div class="cars-grid" *ngIf="!loading && cars.length > 0">
            <div class="car-card" *ngFor="let car of cars">

                <!-- Car Image -->
                <div class="car-image" [style.background-image]="'url(' + getCarMainImage(car) + ')'"
                    (click)="viewCarDetails(car)">
                    <div class="image-overlay">
                        <span class="material-symbols-outlined">visibility</span>
                    </div>
                </div>

                <!-- Car Content -->
                <div class="car-content">
                    <div class="car-header">
                        <h3 class="car-name" (click)="viewCarDetails(car)">{{ car.name }}</h3>
                        <span class="car-subtitle">{{ car.make }} {{ car.model }}</span>
                    </div>

                    <!-- Stats Grid -->
                    <div class="car-stats">
                        <div class="stat" *ngFor="let stat of getCarStats(car)">
                            <span class="material-symbols-outlined stat-icon">{{ stat.icon }}</span>
                            <div class="stat-info">
                                <span class="stat-label">{{ stat.label }}</span>
                                <span class="stat-value">{{ stat.value }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Info -->
                    <div class="car-meta">
                        <div class="meta-item" *ngIf="car.transmission">
                            <span class="material-symbols-outlined">settings</span>
                            <span>{{ getTransmissionLabel(car.transmission) }}</span>
                        </div>
                        <div class="meta-item" *ngIf="car.drivetrain">
                            <span class="material-symbols-outlined">sync_alt</span>
                            <span>{{ getDrivetrainLabel(car.drivetrain) }}</span>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="car-actions">
                        <button class="btn btn--secondary btn--small" (click)="viewCarDetails(car)">
                            <span class="material-symbols-outlined">visibility</span>
                            Details
                        </button>
                        <button class="btn btn--ghost btn--small" (click)="openEditModal(car)">
                            <span class="material-symbols-outlined">edit</span>
                            Bearbeiten
                        </button>
                        <button class="btn btn--danger-ghost btn--small" (click)="deleteCar(car)">
                            <span class="material-symbols-outlined">delete</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<!-- Create Modal -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>Neues Auto hinzufügen</h2>
            <button class="modal-close" (click)="closeModal()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <div class="modal-body">
            <form class="car-form">

                <!-- Basic Info -->
                <div class="form-section">
                    <h3 class="section-title">Grundinformationen</h3>

                    <div class="form-group">
                        <label>Name des Autos *</label>
                        <input type="text" class="input" [(ngModel)]="carForm.name" name="name"
                            placeholder="z.B. Mein Golf GTI" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Marke *</label>
                            <input type="text" class="input" [(ngModel)]="carForm.make" name="make"
                                placeholder="z.B. Volkswagen" required>
                        </div>
                        <div class="form-group">
                            <label>Modell *</label>
                            <input type="text" class="input" [(ngModel)]="carForm.model" name="model"
                                placeholder="z.B. Golf VII GTI" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Baujahr</label>
                            <input type="number" class="input" [(ngModel)]="carForm.modelYear" name="modelYear"
                                placeholder="z.B. 2015" min="1900" max="2030">
                            <span class="input-hint"
                                *ngIf="carForm.modelYear && (carForm.modelYear < 1900 || carForm.modelYear > 2030)">
                                Bitte ein Jahr zwischen 1900 und 2030 eingeben
                            </span>
                        </div>
                        <div class="form-group">
                            <label>Kennzeichen</label>
                            <input type="text" class="input" [(ngModel)]="carForm.licensePlate" name="licensePlate"
                                placeholder="z.B. XX-AB 1234" maxlength="20">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>FIN / VIN (Fahrzeugidentifikationsnummer)</label>
                        <input type="text" class="input" [(ngModel)]="carForm.vin" name="vin"
                            placeholder="z.B. WVWZZZ1JZYW123456" maxlength="50">
                    </div>
                </div>

                <!-- Performance -->
                <div class="form-section">
                    <h3 class="section-title">Leistung & Antrieb</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leistung (PS) *</label>
                            <input type="number" class="input" [(ngModel)]="carForm.horsepowerPs" name="horsepowerPs"
                                placeholder="z.B. 230" min="1" required>
                        </div>
                        <div class="form-group">
                            <label>Drehmoment (Nm)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.torqueNm" name="torqueNm"
                                placeholder="z.B. 350" min="1">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Hubraum (ccm)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.displacementCc"
                                name="displacementCc" placeholder="z.B. 1984" min="1">
                        </div>
                        <div class="form-group">
                            <label>Kraftstoff *</label>
                            <select class="input" [(ngModel)]="carForm.fuel" name="fuel" required>
                                <option [value]="FuelType.PETROL">Benzin</option>
                                <option [value]="FuelType.DIESEL">Diesel</option>
                                <option [value]="FuelType.HYBRID">Hybrid</option>
                                <option [value]="FuelType.ELECTRIC">Elektrisch</option>
                                <option [value]="FuelType.LPG">LPG</option>
                                <option [value]="FuelType.CNG">CNG</option>
                                <option [value]="FuelType.OTHER">Andere</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Aufladung</label>
                            <select class="input" [(ngModel)]="carForm.induction" name="induction">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Induction.NONE">Saugmotor</option>
                                <option [value]="Induction.TURBO">Turbolader</option>
                                <option [value]="Induction.SUPERCHARGER">Kompressor</option>
                                <option [value]="Induction.ELECTRIC">Elektrisch</option>
                                <option [value]="Induction.OTHER">Andere</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Anzahl Gänge</label>
                            <input type="number" class="input" [(ngModel)]="carForm.gears" name="gears"
                                placeholder="z.B. 6" min="1" max="10">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Getriebe</label>
                            <select class="input" [(ngModel)]="carForm.transmission" name="transmission">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Transmission.MANUAL">Manuell</option>
                                <option [value]="Transmission.AUTOMATIC">Automatik</option>
                                <option [value]="Transmission.DSG">DSG</option>
                                <option [value]="Transmission.CVT">CVT</option>
                                <option [value]="Transmission.OTHER">Andere</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Antrieb</label>
                            <select class="input" [(ngModel)]="carForm.drivetrain" name="drivetrain">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Drivetrain.FWD">Frontantrieb</option>
                                <option [value]="Drivetrain.RWD">Heckantrieb</option>
                                <option [value]="Drivetrain.AWD">Allrad</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Body & Weight -->
                <div class="form-section">
                    <h3 class="section-title">Karosserie & Gewicht</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leergewicht (kg)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.kerbWeightKg" name="kerbWeightKg"
                                placeholder="z.B. 1450" min="1" max="5000">
                        </div>
                        <div class="form-group">
                            <label>Karosserieform</label>
                            <select class="input" [(ngModel)]="carForm.bodyType" name="bodyType">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="BodyType.SEDAN">Limousine</option>
                                <option [value]="BodyType.WAGON">Kombi</option>
                                <option [value]="BodyType.COUPE">Coupé</option>
                                <option [value]="BodyType.CONVERTIBLE">Cabrio</option>
                                <option [value]="BodyType.SUV">SUV</option>
                                <option [value]="BodyType.VAN">Van</option>
                                <option [value]="BodyType.PICKUP">Pickup</option>
                                <option [value]="BodyType.HATCHBACK">Schrägheck</option>
                                <option [value]="BodyType.OTHER">Andere</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Anzahl Türen</label>
                            <input type="number" class="input" [(ngModel)]="carForm.doors" name="doors"
                                placeholder="z.B. 5" min="2" max="6">
                        </div>
                        <div class="form-group">
                            <label>Anzahl Sitze</label>
                            <input type="number" class="input" [(ngModel)]="carForm.seats" name="seats"
                                placeholder="z.B. 5" min="1" max="9">
                        </div>
                    </div>
                </div>

                <!-- Mileage & Maintenance -->
                <div class="form-section">
                    <h3 class="section-title">Kilometerstand & Wartung</h3>

                    <div class="form-group">
                        <label>Kilometerstand (km) *</label>
                        <input type="number" class="input" [(ngModel)]="carForm.mileageKm" name="mileageKm"
                            placeholder="z.B. 85000" min="0" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Nächster TÜV</label>
                            <input type="date" class="input" [(ngModel)]="carForm.nextTuvDate" name="nextTuvDate">
                        </div>
                        <div class="form-group">
                            <label>Nächster Service (Datum)</label>
                            <input type="date" class="input" [(ngModel)]="carForm.nextServiceDate"
                                name="nextServiceDate">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Nächster Service (km)</label>
                        <input type="number" class="input" [(ngModel)]="carForm.nextServiceKm" name="nextServiceKm"
                            placeholder="z.B. 90000" min="0">
                    </div>
                </div>

                <!-- Performance Stats (Optional) -->
                <div class="form-section">
                    <h3 class="section-title">Leistungsdaten (Optional)</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>0-100 km/h (Sekunden)</label>
                            <input type="number" step="0.1" class="input" [(ngModel)]="carForm.zeroToHundredS"
                                name="zeroToHundredS" placeholder="z.B. 6.5" min="0" max="99.9">
                        </div>
                        <div class="form-group">
                            <label>Höchstgeschwindigkeit (km/h)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.topSpeedKmh" name="topSpeedKmh"
                                placeholder="z.B. 250" min="0" max="500">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leistungsgewicht (PS/kg)</label>
                            <input type="number" step="0.01" class="input" [(ngModel)]="carForm.powerToWeightPsPerKg"
                                name="powerToWeightPsPerKg" placeholder="z.B. 6.32" min="0">
                        </div>
                        <div class="form-group">
                            <label>Verbrauch (l/100km)</label>
                            <input type="number" step="0.1" class="input" [(ngModel)]="carForm.consumptionLPer100km"
                                name="consumptionLPer100km" placeholder="z.B. 7.5" min="0" max="99.9">
                        </div>
                    </div>
                </div>

                <!-- Images -->
                <div class="form-section">
                    <h3 class="section-title">Bilder</h3>

                    <div class="image-upload-zone">
                        <input type="file" id="imageUpload" accept="image/*" multiple (change)="onImageSelect($event)"
                            style="display: none">

                        <label for="imageUpload" class="upload-label">
                            <span class="material-symbols-outlined">add_photo_alternate</span>
                            <span>Bilder hinzufügen</span>
                            <span class="upload-hint">Klicken oder ziehen Sie Bilder hierher</span>
                        </label>
                    </div>

                    <!-- Image Previews -->
                    <div class="image-previews" *ngIf="imagePreviewUrls.length > 0">
                        <div class="image-preview" *ngFor="let url of imagePreviewUrls; let i = index">
                            <img [src]="url" alt="Preview">
                            <button type="button" class="remove-image" (click)="removeImage(i)">
                                <span class="material-symbols-outlined">close</span>
                            </button>
                        </div>
                    </div>
                </div>

            </form>
        </div>

        <div class="modal-footer">
            <button class="btn btn--ghost" (click)="closeModal()">Abbrechen</button>
            <button class="btn btn--primary" (click)="createCar()" [disabled]="loading">
                <span class="material-symbols-outlined" *ngIf="!loading">save</span>
                <span class="spinner-small" *ngIf="loading"></span>
                {{ loading ? 'Speichere...' : 'Auto erstellen' }}
            </button>
        </div>
    </div>
</div>

<!-- Edit Modal - VOLLSTÄNDIG MIT ALLEN FELDERN -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h2>Auto bearbeiten</h2>
            <button class="modal-close" (click)="closeModal()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <div class="modal-body">
            <form class="car-form">

                <!-- Basic Info -->
                <div class="form-section">
                    <h3 class="section-title">Grundinformationen</h3>

                    <div class="form-group">
                        <label>Name des Autos *</label>
                        <input type="text" class="input" [(ngModel)]="carForm.name" name="editName"
                            placeholder="z.B. Mein Golf GTI" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Marke *</label>
                            <input type="text" class="input" [(ngModel)]="carForm.make" name="editMake"
                                placeholder="z.B. Volkswagen" required>
                        </div>
                        <div class="form-group">
                            <label>Modell *</label>
                            <input type="text" class="input" [(ngModel)]="carForm.model" name="editModel"
                                placeholder="z.B. Golf VII GTI" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Baujahr</label>
                            <input type="number" class="input" [(ngModel)]="carForm.modelYear" name="editModelYear"
                                placeholder="z.B. 2015" min="1900" max="2030">
                            <span class="input-hint"
                                *ngIf="carForm.modelYear && (carForm.modelYear < 1900 || carForm.modelYear > 2030)">
                                Bitte ein Jahr zwischen 1900 und 2030 eingeben
                            </span>
                        </div>
                        <div class="form-group">
                            <label>Kennzeichen</label>
                            <input type="text" class="input" [(ngModel)]="carForm.licensePlate" name="editLicensePlate"
                                placeholder="z.B. XX-AB 1234" maxlength="20">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>FIN / VIN (Fahrzeugidentifikationsnummer)</label>
                        <input type="text" class="input" [(ngModel)]="carForm.vin" name="editVin"
                            placeholder="z.B. WVWZZZ1JZYW123456" maxlength="50">
                    </div>
                </div>

                <!-- Performance -->
                <div class="form-section">
                    <h3 class="section-title">Leistung & Antrieb</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leistung (PS) *</label>
                            <input type="number" class="input" [(ngModel)]="carForm.horsepowerPs"
                                name="editHorsepowerPs" placeholder="z.B. 230" min="1" required>
                        </div>
                        <div class="form-group">
                            <label>Drehmoment (Nm)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.torqueNm" name="editTorqueNm"
                                placeholder="z.B. 350" min="1">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Hubraum (ccm)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.displacementCc"
                                name="editDisplacementCc" placeholder="z.B. 1984" min="1">
                        </div>
                        <div class="form-group">
                            <label>Kraftstoff *</label>
                            <select class="input" [(ngModel)]="carForm.fuel" name="editFuel" required>
                                <option [value]="FuelType.PETROL">Benzin</option>
                                <option [value]="FuelType.DIESEL">Diesel</option>
                                <option [value]="FuelType.HYBRID">Hybrid</option>
                                <option [value]="FuelType.ELECTRIC">Elektrisch</option>
                                <option [value]="FuelType.LPG">LPG</option>
                                <option [value]="FuelType.CNG">CNG</option>
                                <option [value]="FuelType.OTHER">Andere</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Aufladung</label>
                            <select class="input" [(ngModel)]="carForm.induction" name="editInduction">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Induction.NONE">Saugmotor</option>
                                <option [value]="Induction.TURBO">Turbolader</option>
                                <option [value]="Induction.SUPERCHARGER">Kompressor</option>
                                <option [value]="Induction.ELECTRIC">Elektrisch</option>
                                <option [value]="Induction.OTHER">Andere</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Anzahl Gänge</label>
                            <input type="number" class="input" [(ngModel)]="carForm.gears" name="editGears"
                                placeholder="z.B. 6" min="1" max="10">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Getriebe</label>
                            <select class="input" [(ngModel)]="carForm.transmission" name="editTransmission">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Transmission.MANUAL">Manuell</option>
                                <option [value]="Transmission.AUTOMATIC">Automatik</option>
                                <option [value]="Transmission.DSG">DSG</option>
                                <option [value]="Transmission.CVT">CVT</option>
                                <option [value]="Transmission.OTHER">Andere</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Antrieb</label>
                            <select class="input" [(ngModel)]="carForm.drivetrain" name="editDrivetrain">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="Drivetrain.FWD">Frontantrieb</option>
                                <option [value]="Drivetrain.RWD">Heckantrieb</option>
                                <option [value]="Drivetrain.AWD">Allrad</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Body & Weight -->
                <div class="form-section">
                    <h3 class="section-title">Karosserie & Gewicht</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leergewicht (kg)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.kerbWeightKg"
                                name="editKerbWeightKg" placeholder="z.B. 1450" min="1" max="5000">
                        </div>
                        <div class="form-group">
                            <label>Karosserieform</label>
                            <select class="input" [(ngModel)]="carForm.bodyType" name="editBodyType">
                                <option [value]="undefined">Keine Angabe</option>
                                <option [value]="BodyType.SEDAN">Limousine</option>
                                <option [value]="BodyType.WAGON">Kombi</option>
                                <option [value]="BodyType.COUPE">Coupé</option>
                                <option [value]="BodyType.CONVERTIBLE">Cabrio</option>
                                <option [value]="BodyType.SUV">SUV</option>
                                <option [value]="BodyType.VAN">Van</option>
                                <option [value]="BodyType.PICKUP">Pickup</option>
                                <option [value]="BodyType.HATCHBACK">Schrägheck</option>
                                <option [value]="BodyType.OTHER">Andere</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Anzahl Türen</label>
                            <input type="number" class="input" [(ngModel)]="carForm.doors" name="editDoors"
                                placeholder="z.B. 5" min="2" max="6">
                        </div>
                        <div class="form-group">
                            <label>Anzahl Sitze</label>
                            <input type="number" class="input" [(ngModel)]="carForm.seats" name="editSeats"
                                placeholder="z.B. 5" min="1" max="9">
                        </div>
                    </div>
                </div>

                <!-- Mileage & Maintenance -->
                <div class="form-section">
                    <h3 class="section-title">Kilometerstand & Wartung</h3>

                    <div class="form-group">
                        <label>Kilometerstand (km) *</label>
                        <input type="number" class="input" [(ngModel)]="carForm.mileageKm" name="editMileageKm"
                            placeholder="z.B. 85000" min="0" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Nächster TÜV</label>
                            <input type="date" class="input" [(ngModel)]="carForm.nextTuvDate" name="editNextTuvDate">
                        </div>
                        <div class="form-group">
                            <label>Nächster Service (Datum)</label>
                            <input type="date" class="input" [(ngModel)]="carForm.nextServiceDate" name="editNextServiceDate">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Nächster Service (km)</label>
                        <input type="number" class="input" [(ngModel)]="carForm.nextServiceKm" name="editNextServiceKm"
                            placeholder="z.B. 90000" min="0">
                    </div>
                </div>

                <!-- Performance Stats (Optional) -->
                <div class="form-section">
                    <h3 class="section-title">Leistungsdaten (Optional)</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>0-100 km/h (Sekunden)</label>
                            <input type="number" step="0.1" class="input" [(ngModel)]="carForm.zeroToHundredS"
                                name="editZeroToHundredS" placeholder="z.B. 6.5" min="0" max="99.9">
                        </div>
                        <div class="form-group">
                            <label>Höchstgeschwindigkeit (km/h)</label>
                            <input type="number" class="input" [(ngModel)]="carForm.topSpeedKmh" name="editTopSpeedKmh"
                                placeholder="z.B. 250" min="0" max="500">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Leistungsgewicht (PS/kg)</label>
                            <input type="number" step="0.01" class="input" [(ngModel)]="carForm.powerToWeightPsPerKg"
                                name="editPowerToWeightPsPerKg" placeholder="z.B. 6.32" min="0">
                        </div>
                        <div class="form-group">
                            <label>Verbrauch (l/100km)</label>
                            <input type="number" step="0.1" class="input" [(ngModel)]="carForm.consumptionLPer100km"
                                name="editConsumptionLPer100km" placeholder="z.B. 7.5" min="0" max="99.9">
                        </div>
                    </div>
                </div>

                <!-- Images -->
                <div class="form-section">
                    <h3 class="section-title">Bilder</h3>

                    <div class="image-upload-zone">
                        <input type="file" id="imageUploadEdit" accept="image/*" multiple
                            (change)="onImageSelect($event)" style="display: none">

                        <label for="imageUploadEdit" class="upload-label">
                            <span class="material-symbols-outlined">add_photo_alternate</span>
                            <span>Bilder hinzufügen</span>
                            <span class="upload-hint">Klicken oder ziehen Sie Bilder hierher</span>
                        </label>
                    </div>

                    <!-- Image Previews -->
                    <div class="image-previews" *ngIf="uploadedImages.length > 0">
                        <div class="image-preview" *ngFor="let img of uploadedImages; let i = index">
                            <img [src]="img.image" alt="Preview">
                            <button type="button" class="remove-image" (click)="removeImage(i)">
                                <span class="material-symbols-outlined">close</span>
                            </button>
                        </div>
                    </div>
                </div>

            </form>
        </div>

        <div class="modal-footer">
            <button class="btn btn--ghost" (click)="closeModal()">Abbrechen</button>
            <button class="btn btn--primary" (click)="updateCar()" [disabled]="loading">
                <span class="material-symbols-outlined" *ngIf="!loading">save</span>
                <span class="spinner-small" *ngIf="loading"></span>
                {{ loading ? 'Speichere...' : 'Änderungen speichern' }}
            </button>
        </div>
    </div>
</div>